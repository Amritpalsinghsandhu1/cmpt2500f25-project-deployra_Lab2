
def train_random_forest(X_train, y_train, tune_hyperparameters=False): 
""" 
    Train Random Forest Classifier. 
    Args: 
        X_train: Training features 
        y_train: Training labels 
        tune_hyperparameters: If True, use GridSearchCV 
    Returns: 
        Trained model 
    """ 
if tune_hyperparameters: 
        print("Training with hyperparameter tuning (this may take a 
while)...") 
        param_grid = { 
'n_estimators': [50, 100, 200], 
'max_depth': [10, 20, None], 
'min_samples_split': [2, 5], 
'min_samples_leaf': [1, 2] 
        } 
        model = RandomForestClassifier(random_state=42) 
        grid_search = GridSearchCV( 
            estimator=model, 
            param_grid=param_grid, 
            cv=5, 
            scoring='accuracy', 
            n_jobs=-1, 
            verbose=1 
        ) 
        grid_search.fit(X_train, y_train) 
        print(f"Best parameters: {grid_search.best_params_}") 
        print(f"Best CV score: {grid_search.best_score_:.4f}") 
return grid_search.best_estimator_ 
else: 
 ) 
        model.fit(X_train, y_train) 
return model
        print("Training with default hyperparameters...") 
        model = RandomForestClassifier( 
            n_estimators=100, 
            max_depth=10, 
            random_state=42 
